#include <LiquidCrystal.h>

LiquidCrystal lcd(12, 11, 5, 4, 3, 2);

const int N = 101;
float x_vals[N] = {0,	1,	2,	3,	4,	5,	6,	7,	8,	9,	10,	11,	12,	13,	14,	15,	16,	17,	18,	19,	20,	21,	22,	23,	24,	25,	26,	27,	28,	29,	30,	31,	32,	33,	34,	35,	36,	37,	38,	39,	40,	41,	42,	43,	44,	45,	46,	47,	48,	49,	50,	51,	52,	53,	54,	55,	56,	57,	58,	59,	60,	61,	62,	63,	64,	65,	66,	67,	68,	69,	70,	71,	72,	73,	74,	75,	76,	77,	78,	79,	80,	81,	82,	83,	84,	85,	86,	87,	88,	89,	90,	91,	92,	93,	94,	95,	96,	97,	98,	99,	100};
float y_vals[N] = {4.77689195621133,	4.76613657623948,	4.7549420029407,	4.74329134720701,	4.73117316032833,	4.71857410881801,	4.70547810720597,	4.69189055952674,	4.67777968723148,	4.66313330937837,	4.64760607057276,	4.63220870929776,	4.61589675304722,	4.59901625320787,	4.58154326842605,	4.56347127640999,	4.54479242534596,	4.52549664684297,	4.50557057156042,	4.48499622330564,	4.46378780295989,	4.44192276211028,	4.41941477008825,	4.39618388213509,	4.37233241275421,	4.34782608695652,	4.32255442146148,	4.2966991747937,	4.27007299270073,	4.24280666330136,	4.21482412060302,	4.18619791666667,	4.15692446043165,	4.12689173457509,	4.09616775126537,	4.06483790523691,	4.03288201160542,	4.00026659557451,	3.96694214876033,	3.93299189073837,	3.89851666911441,	3.86329190663838,	3.82757542598093,	3.79110251450677,	3.75435974090683,	3.71685201026518,	3.6788796899771,	3.64031907179115,	3.6015289949655,	3.56211656441718,	3.52594339622642,	3.48178137651822,	3.44107254209104,	3.40017064846416,	3.35850295469468,	3.31687612208259,	3.27506899724011,	3.23279924599435,	3.19015444015444,	3.14723320158103,	3.10462471569371,	3.06151460325666,	3.01797040169133,	2.97516198704104,	2.93160507446222,	2.88791889608561,	2.8448275862069,	2.80123131046614,	2.75784753363229,	2.71480804387569,	2.67153058056504,	2.62883338602592,	2.58531873792659,	2.54259501965924,	2.5,	2.45762711864407,	2.41557546519642,	2.37394957983193,	2.33285917496444,	2.29144095341278,	2.25073313782991,	2.20982142857143,	2.16981132075472,	2.12973593570608,	2.09076803723817,	2.05188679245283,	2.0131421744325,	1.97458652682533,	1.93627450980392,	1.89954526663911,	1.86323713927227,	1.82606855691917,	1.79075738125802,	1.75465166594548,	1.72059466550066,	1.6858152894388,	1.65178571428571,	1.61857529305681,	1.58625398270369,	1.55330882352941,	1.52294853963839}; 


const int ledPin = 9;  

void setup() {
  // Inicie a comunicação serial
  Serial.begin(9600);

  lcd.begin(16, 2);

  pinMode(ledPin, OUTPUT);
}

void loop() {
  // Leia o valor do pino A0 (0-1023)
  int sensorValue = analogRead(A0);

  // Converta a leitura para uma tensão real (0-5V)
  float Vout = sensorValue * (5.0 / 1023.0);

  //calculo temperatura
  //float Temp = -3.37*Vout*Vout -6.15*Vout + 113;

  float Temp = interpolar(Vout);

  //Limpa a tela
  lcd.clear();
  //Posiciona o cursor na coluna 3, linha 0;
  lcd.setCursor(1, 0);
  //Envia o texto entre aspas para o LCD
  lcd.print("Temperatura: ");
  lcd.setCursor(1, 1);
  lcd.print(Temp);
  lcd.setCursor(7, 1);
  lcd.print("C");


/*
  // Mostre os valores no Serial Monitor
  Serial.print("Vout: ");
  Serial.print(Vout);
  Serial.println(" V");
*/
  Serial.print("Temperatura: ");
  Serial.print(Temp);
  Serial.println(" C");


  delay(100);

}

float interpolar(float x) {
  for (int i = 0; i < N - 1; i++) {
    if (x >= y_vals[i+1] && x <= y_vals[i]) {
      return x_vals[i] + (x_vals[i + 1] - x_vals[i]) * ((x - y_vals[i+1]) / (y_vals[i] - y_vals[i+1]));
    }
  }
  return 0;
}

  


